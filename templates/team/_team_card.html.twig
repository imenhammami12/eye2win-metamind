<div class="card h-100 shadow-sm">
    {% if team.logo %}
    <img src="{{ asset('uploads/teams/' ~ team.logo) }}" class="card-img-top" alt="{{ team.name }}" style="height: 200px; object-fit: cover;">
    {% else %}
    <div class="card-img-top bg-gradient" style="height: 200px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center;">
        <h2 class="text-white">{{ team.name|slice(0, 2)|upper }}</h2>
    </div>
    {% endif %}
    
    <div class="card-body">
        <h5 class="card-title">
            {{ team.name }}
            {% if isOwner %}
            <span class="badge bg-warning text-dark"><i class="fas fa-crown"></i> Owner</span>
            {% endif %}
        </h5>
        
        <p class="card-text text-muted small">
            <i class="fas fa-user"></i> {{ team.owner.username }}
        </p>
        
        {% if team.description %}
        <p class="card-text">{{ team.description|slice(0, 100) }}{% if team.description|length > 100 %}...{% endif %}</p>
        {% endif %}
        
        <div class="mb-3">
            <span class="badge bg-primary">
                <i class="fas fa-users"></i> 
                {% set activeCount = team.teamMemberships|filter(m => m.status.value == 'ACTIVE')|length %}
                {{ activeCount }}/{{ team.maxMembers }} members
            </span>
            {% if team.isActive %}
            <span class="badge bg-success">Active</span>
            {% else %}
            <span class="badge bg-secondary">Inactive</span>
            {% endif %}
        </div>


{% if not isOwner %}
    {% set userIsMember = false %}
    {% set hasPendingRequest = false %}
    {% for membership in team.teamMemberships %}
        {% if membership.user == app.user %}
            {% if membership.status.value == 'ACTIVE' %}
                {% set userIsMember = true %}
            {% elseif membership.status.value == 'PENDING' %}
                {% set hasPendingRequest = true %}
            {% endif %}
        {% endif %}
    {% endfor %}
    
    {% if not userIsMember and not hasPendingRequest and team.isActive %}
        {% set activeCount = team.teamMemberships|filter(m => m.status.value == 'ACTIVE')|length %}
        {% if activeCount < team.maxMembers %}
        <form method="post" action="{{ path('app_teams_request_join', {id: team.id}) }}" class="d-inline">
            <button type="submit" class="btn btn-success btn-sm mb-2 w-100">
                <i class="fas fa-user-plus"></i> Request to Join
            </button>
        </form>
        {% endif %}
    {% elseif hasPendingRequest %}
        <button class="btn btn-warning btn-sm mb-2 w-100" disabled>
            <i class="fas fa-hourglass-half"></i> Request Pending
        </button>
    {% endif %}
{% endif %}

<a href="{{ path('app_teams_show', {id: team.id}) }}" class="btn btn-primary btn-sm">
    <i class="fas fa-eye"></i> View Team
</a>

        
        {% if isOwner %}
        <a href="{{ path('app_teams_edit', {id: team.id}) }}" class="btn btn-secondary btn-sm">
            <i class="fas fa-edit"></i> Edit
        </a>
        {% endif %}
    </div>
    
    <div class="card-footer text-muted small">
        <i class="fas fa-calendar"></i> Created on {{ team.createdAt|date('m/d/Y') }}
    </div>
</div>
